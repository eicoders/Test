<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Corporate Secure Portal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap');

        * { box-sizing: border-box; outline: none; }

        body {
            background: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            font-family: 'Poppins', sans-serif;
            height: 100vh;
            margin: 0;
        }

        h1 { font-weight: bold; margin: 0; color: #0e2a47; }
        p { font-size: 14px; font-weight: 400; line-height: 20px; letter-spacing: 0.5px; margin: 20px 0 30px; color: #555; }
        
        button {
            border-radius: 8px;
            border: 1px solid #0e2a47;
            background-color: #0e2a47;
            color: #FFFFFF;
            font-size: 12px;
            font-weight: bold;
            padding: 12px 45px;
            letter-spacing: 1px;
            text-transform: uppercase;
            transition: transform 80ms ease-in;
            cursor: pointer;
            margin-top: 10px;
            width: 100%;
        }

        button:active { transform: scale(0.95); }
        button:disabled { background-color: #95a5a6; border-color: #95a5a6; cursor: not-allowed; }
        button.ghost { background-color: transparent; border-color: #FFFFFF; }

        form {
            background-color: #FFFFFF;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: 0 40px;
            height: 100%;
            text-align: center;
        }

        input {
            background-color: #f4f8f7;
            border: 1px solid #e0e0e0;
            padding: 12px 15px;
            margin: 8px 0;
            width: 100%;
            border-radius: 5px;
            font-size: 14px;
        }

        .container {
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 14px 28px rgba(0,0,0,0.1), 0 10px 10px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
            width: 900px;
            max-width: 100%;
            min-height: 650px;
        }

        .form-container {
            position: absolute;
            top: 0;
            height: 100%;
            transition: all 0.6s ease-in-out;
        }

        .sign-in-container { left: 0; width: 50%; z-index: 2; }
        .container.right-panel-active .sign-in-container { transform: translateX(100%); }
        .sign-up-container { left: 0; width: 50%; opacity: 0; z-index: 1; }
        .container.right-panel-active .sign-up-container { transform: translateX(100%); opacity: 1; z-index: 5; animation: show 0.6s; }

        @keyframes show {
            0%, 49.99% { opacity: 0; z-index: 1; }
            50%, 100% { opacity: 1; z-index: 5; }
        }

        .overlay-container {
            position: absolute;
            top: 0;
            left: 50%;
            width: 50%;
            height: 100%;
            overflow: hidden;
            transition: transform 0.6s ease-in-out;
            z-index: 100;
        }

        .container.right-panel-active .overlay-container { transform: translateX(-100%); }

        .overlay {
            background: linear-gradient(to right, #141e30, #243b55);
            color: #FFFFFF;
            position: relative;
            left: -100%;
            height: 100%;
            width: 200%;
            transform: translateX(0);
            transition: transform 0.6s ease-in-out;
        }

        .container.right-panel-active .overlay { transform: translateX(50%); }

        .overlay-panel {
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            padding: 0 40px;
            text-align: center;
            top: 0;
            height: 100%;
            width: 50%;
            transform: translateX(0);
            transition: transform 0.6s ease-in-out;
        }

        .overlay-panel p { color: #fff; }
        .overlay-left { transform: translateX(-20%); }
        .container.right-panel-active .overlay-left { transform: translateX(0); }
        .overlay-right { right: 0; transform: translateX(0); }
        .container.right-panel-active .overlay-right { transform: translateX(20%); }

        .row-inputs { display: flex; gap: 10px; width: 100%; }
        .password-wrapper { position: relative; width: 100%; }
        .toggle-password { position: absolute; right: 15px; top: 50%; transform: translateY(-50%); cursor: pointer; color: #999; }

        /* Debug Box Style */
        #debugConsole {
            background: #000; color: #0f0; padding: 15px; margin: 20px; 
            border: 2px solid red; font-family: monospace; display: none; 
            width: 90%; max-width: 800px; border-radius: 8px;
            text-align: left; font-size: 12px;
        }

        @media (max-width: 768px) {
            .container { width: 100%; min-height: 850px; border-radius: 0; }
            .overlay-container { display: none; }
            .sign-in-container, .sign-up-container { width: 100%; position: relative; height: auto; padding-top: 50px; }
            .sign-up-container { opacity: 1; z-index: 1; display: none; }
            .container.mobile-show-signup .sign-in-container { display: none; }
            .container.mobile-show-signup .sign-up-container { display: flex; animation: none; opacity: 1; }
            .mobile-toggle { display: block; margin-top: 20px; color: #0e2a47; font-weight: bold; cursor: pointer;}
        }
        @media (min-width: 769px) { .mobile-toggle { display: none; } }
    </style>
</head>
<body>

<div id="debugConsole">
    <h3 style="margin:0 0 10px 0; border-bottom:1px solid #444;">DEBUG LOG (Send Screenshot if Error):</h3>
    <div id="logOutput"></div>
</div>

<div class="container" id="mainContainer">
    
    <div class="form-container sign-up-container">
        <form id="signupForm">
            <h1>Create Account</h1>
            <p>Enter details strictly for corporate use</p>
            
            <div class="row-inputs">
                <input type="text" id="regFName" placeholder="First Name" required />
                <input type="text" id="regLName" placeholder="Last Name" required />
            </div>
            
            <input type="email" id="regEmail" placeholder="Email Address" required />
            <input type="tel" id="regMobile" placeholder="Mobile Number" pattern="[0-9]{10}" required />
            
            <div class="password-wrapper">
                <input type="password" id="regPass" placeholder="Password (Max 16 chars)" maxlength="16" required />
                <i class="fas fa-eye toggle-password" onclick="toggleVisibility('regPass', this)"></i>
            </div>
            
            <div class="password-wrapper">
                <input type="password" id="regConfirmPass" placeholder="Confirm Password" maxlength="16" required />
            </div>
            
            <button type="submit" id="btnRegister">Sign Up</button>
            <span class="mobile-toggle" onclick="showLoginMobile()">Already have an account? Sign In</span>
        </form>
    </div>

    <div class="form-container sign-in-container">
        <form id="loginForm">
            <h1>Sign In</h1>
            <p>Welcome back to the workspace</p>
            
            <input type="email" id="loginEmail" placeholder="Email" required />
            
            <div class="password-wrapper">
                <input type="password" id="loginPass" placeholder="Password" required />
                <i class="fas fa-eye toggle-password" onclick="toggleVisibility('loginPass', this)"></i>
            </div>
            
            <div style="display:flex; justify-content:space-between; width:100%; margin-top:10px; font-size:12px;">
                <label><input type="checkbox" id="rememberMe"> Remember Me</label>
                <a href="#" onclick="alert('Forgot Password feature requires setup first.')">Forgot Password?</a>
            </div>
            
            <button type="submit" id="btnLogin">Sign In</button>
            <span class="mobile-toggle" onclick="showSignupMobile()">New here? Create Account</span>
        </form>
    </div>

    <div class="overlay-container">
        <div class="overlay">
            <div class="overlay-panel overlay-left">
                <h1>Welcome Back!</h1>
                <p>Login with your verified corporate account</p>
                <button class="ghost" id="signInBtn">Sign In</button>
            </div>
            <div class="overlay-panel overlay-right">
                <h1>Hello, Professional!</h1>
                <p>Enter your details and start your journey</p>
                <button class="ghost" id="signUpBtn">Sign Up</button>
            </div>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<script>
    // --- ERROR LOGGING SYSTEM ---
    const debugBox = document.getElementById('debugConsole');
    const logOutput = document.getElementById('logOutput');

    function showLog(message, isError = false) {
        debugBox.style.display = 'block';
        const color = isError ? '#ff4444' : '#00ff00';
        const time = new Date().toLocaleTimeString();
        logOutput.innerHTML += `<div style="color:${color}; margin-bottom:5px;">[${time}] ${message}</div>`;
    }

    window.onerror = function(message, source, lineno, colno, error) {
        showLog("SYSTEM ERROR: " + message, true);
    };

    // --- FIREBASE CONFIGURATION ---
    // TODO: अपनी Keys यहाँ Paste करें
    const firebaseConfig = {
  apiKey: "AIzaSyCG9w-pUJq9FopmIUUPLUVMc03P84Rblgw",
  authDomain: "jar-ledger.firebaseapp.com",
  databaseURL: "https://jar-ledger-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "jar-ledger",
  storageBucket: "jar-ledger.firebasestorage.app",
  messagingSenderId: "915159281904",
  appId: "1:915159281904:web:4f3d5c940a03c4b525d235",
  measurementId: "G-YB740FJBBG"
};

    let auth, db;

    // Initialize
    try {
        if(firebaseConfig.apiKey === "YOUR_API_KEY") {
            showLog("WARNING: Default API Key found. Please update config.", true);
        }
        firebase.initializeApp(firebaseConfig);
        auth = firebase.auth();
        db = firebase.firestore();
        console.log("Firebase initialized");
    } catch (e) {
        showLog("INIT ERROR: " + e.message, true);
    }

    // --- UI LOGIC ---
    const container = document.getElementById('mainContainer');
    document.getElementById('signUpBtn').addEventListener('click', () => container.classList.add("right-panel-active"));
    document.getElementById('signInBtn').addEventListener('click', () => container.classList.remove("right-panel-active"));
    window.showSignupMobile = () => container.classList.add("mobile-show-signup");
    window.showLoginMobile = () => container.classList.remove("mobile-show-signup");
    window.toggleVisibility = (id, icon) => {
        const x = document.getElementById(id);
        if(x.type === "password"){ x.type = "text"; icon.classList.replace('fa-eye', 'fa-eye-slash'); }
        else { x.type = "password"; icon.classList.replace('fa-eye-slash', 'fa-eye'); }
    }

    // --- SIGN UP LOGIC ---
    document.getElementById('signupForm').addEventListener('submit', (e) => {
        e.preventDefault();
        const btn = document.getElementById('btnRegister');
        const email = document.getElementById('regEmail').value;
        const pass = document.getElementById('regPass').value;
        const fName = document.getElementById('regFName').value;
        const lName = document.getElementById('regLName').value;
        const mobile = document.getElementById('regMobile').value;

        btn.innerText = "PROCESSING...";
        btn.disabled = true;
        showLog("Starting registration...");

        auth.createUserWithEmailAndPassword(email, pass)
            .then((cred) => {
                showLog("User created in Auth.");
                const user = cred.user;
                user.updateProfile({ displayName: fName + " " + lName });
                
                return db.collection("users").doc(user.uid).set({
                    firstName: fName, lastName: lName, email: email, mobile: mobile
                });
            })
            .then(() => {
                showLog("Data saved to Firestore.");
                const user = auth.currentUser;
                return user.sendEmailVerification();
            })
            .then(() => {
                showLog("Verification Email Sent!");
                alert("SUCCESS: Verification email sent to " + email + ". Please verify.");
                auth.signOut();
                window.location.reload();
            })
            .catch((error) => {
                console.error(error);
                showLog("FAIL: " + error.code + " - " + error.message, true);
                
                if(error.code === 'auth/unauthorized-domain') {
                    alert("DOMAIN ERROR:\nGo to Firebase Console > Authentication > Settings > Authorized Domains.\nAdd 'eicoders.github.io'");
                } else {
                    alert("Error: " + error.message);
                }
                
                btn.innerText = "Sign Up";
                btn.disabled = false;
            });
    });
</script>

</body>
</html>
